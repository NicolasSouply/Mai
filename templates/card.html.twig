{% extends 'layout.html.twig' %}

{% block main %}
<main class="content">
    <section class="card-page">
        <section class="card-page__container">
            <div class="card-page__blur">
                <h3>La carte</h3>
            </div>
        </section>
    </section>

    <section class="dishes-section">
        <div class="content">
            <aside class="sidebar">
                <ul>
                    <li><a href="#starter">Nos entrées</a></li>
                    <li><a href="#main-courses">Nos plats</a></li>
                    <li><a href="#desserts">Nos desserts</a></li>
                    <li><a href="#drinks">Nos boissons</a></li>
                    <button class="filter-button" id="filter-vegetarian">Filtre pour les plats végétariens</button>
                </ul>
            </aside>

            <div class="dishes-list">
                <!-- Entrées -->
                <div id="starter" class="dish-category">
                    <h3>Nos entrées</h3>
                    <div class="grid-container">
                        {% set hasEntries = false %}
                        {% for dish in dishes %}
                            {% if dish.category == 'entrée' %}
                                <div class="dish-item">
                                    <p>Nom : {{ dish.name|e }}</p>
                                    <p>Description : {{ dish.description|e }}</p>
                                    <p>Prix : {{ dish.price|e }}€</p>
                                    <p>Végétarien : {{ dish.isVegetarian ? 'Oui' : 'Non' }}</p>
                                    <img src="ServeurFichiers.php?file={{ dish.picture }}" alt="{{ dish.name }}" width="100">
                                    <!-- Bouton pour ouvrir la modale -->
                                    <button class="details-button" data-modal-id="modal-{{ dish.id }}" data-description="{{ dish.description|e }}">Détails</button>
                                </div>
                                {% set hasEntries = true %}
                            {% endif %}
                        {% endfor %}
                        {% if not hasEntries %}
                            <p>Aucune entrée disponible pour le moment.</p>
                        {% endif %}
                    </div>
                </div>

                <!-- Plats -->
                <div id="main-courses" class="dish-category">
                    <h3>Nos plats</h3>
                    <div class="grid-container">
                        {% set hasMainCourses = false %}
                        {% for dish in dishes %}
                            {% if dish.category == 'plat' %}
                                <div class="dish-item">
                                    <p>Nom : {{ dish.name|e }}</p>
                                    <p>Description : {{ dish.description|e }}</p>
                                    <p>Prix : {{ dish.price|e }}€</p>
                                    <p>Végétarien : {{ dish.isVegetarian ? 'Oui' : 'Non' }}</p>
                                    <img src="ServeurFichiers.php?file={{ dish.picture }}" alt="{{ dish.name }}" width="100">
                                    <!-- Bouton pour ouvrir la modale -->
                                    <button class="details-button" data-modal-id="modal-{{ dish.id }}" data-description="{{ dish.description|e }}">Détails</button>
                                </div>
                                {% set hasMainCourses = true %}
                            {% endif %}
                        {% endfor %}
                        {% if not hasMainCourses %}
                            <p>Aucun plat disponible pour le moment.</p>
                        {% endif %}
                    </div>
                </div>

                <!-- Desserts -->
                <div id="desserts" class="dish-category">
                    <h3>Nos desserts</h3>
                    <div class="grid-container">
                        {% set hasDesserts = false %}
                        {% for dish in dishes %}
                            {% if dish.category == 'dessert' %}
                                <div class="dish-item">
                                    <p>Nom : {{ dish.name|e }}</p>
                                    <p>Description : {{ dish.description|e }}</p>
                                    <p>Prix : {{ dish.price|e }}€</p>
                                    <p>Végétarien : {{ dish.isVegetarian ? 'Oui' : 'Non' }}</p>
                                    <img src="ServeurFichiers.php?file={{ dish.picture }}" alt="{{ dish.name }}" width="100">
                                    <!-- Bouton pour ouvrir la modale -->
                                    <button class="details-button" data-modal-id="modal-{{ dish.id }}" data-description="{{ dish.description|e }}">Détails</button>
                                </div>
                                {% set hasDesserts = true %}
                            {% endif %}
                        {% endfor %}
                        {% if not hasDesserts %}
                            <p>Aucun dessert disponible pour le moment.</p>
                        {% endif %}
                    </div>
                </div>

                <!-- Boissons -->
                <div id="drinks" class="dish-category">
                    <h3>Nos boissons</h3>
                    <div class="grid-container">
                        {% set hasDrinks = false %}
                        {% for dish in dishes %}
                            {% if dish.category == 'boisson' %}
                                <div class="dish-item">
                                    <p>Nom : {{ dish.name|e }}</p>
                                    <p>Description : {{ dish.description|e }}</p>
                                    <p>Prix : {{ dish.price|e }}€</p>
                                    <p>Végétarien : {{ dish.isVegetarian ? 'Oui' : 'Non' }}</p>
                                    <img src="ServeurFichiers.php?file={{ dish.picture }}" alt="{{ dish.name }}" width="100">
                                    <!-- Bouton pour ouvrir la modale -->
                                    <button class="details-button" data-modal-id="modal-{{ dish.id }}" data-description="{{ dish.description|e }}">Détails</button>
                                </div>
                                {% set hasDrinks = true %}
                            {% endif %}
                        {% endfor %}
                        {% if not hasDrinks %}
                            <p>Aucune boisson disponible pour le moment.</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Modale pour les détails des plats -->
    <div class="modal" id="details-modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h3 id="modal-title"></h3>
            <img id="modal-image" src="" alt="">
            <p id="modal-description"></p>
            <p id="modal-price"></p>
            <p id="modal-vegetarian"></p>
        </div>
    </div>
</main>
{% endblock %}
